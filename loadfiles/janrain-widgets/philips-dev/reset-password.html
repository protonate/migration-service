<!DOCTYPE html>
<html>
	<head>
		<link href="http://cdn.quilt.janrain.com/2.1.1/quilt.css" media="all" rel="stylesheet" type="text/css" />
		<script type="text/javascript">
			function getCookie(name) {
				var nameEQ = name + "=";
				var cookies = document.cookie.split(';');
				for(var i = 0; i < cookies.length; i++) {
					var c = cookies[i];
					while (c.charAt(0) == ' ') c = c.substring(1, c.length);
					if (c.indexOf(nameEQ) == 0) {
						return c.substring(nameEQ.length, c.length);
					}
				}
				return null;
			}
			function removeParam(url, paramName) {
				var queryRegex = /\?(.*)/;
				var query = queryRegex.exec(url);
				if (query) {
					url = url.replace(queryRegex, '');
					var params = query[1].split('&');
					var first = true;
					for (var i in params) {
						var parts = params[i].split('=');
						if (parts[0] != paramName) {
							if (first) {
								url += '?';
								first = false;
							} else {
								url += '&';
							}
							url += params[i];
						}
					}
				}
				return url;
			}
			(function() {
				if (typeof window.janrain !== 'object') window.janrain = {};
				window.janrain.settings = {};
				window.janrain.settings.capture = {};

				janrain.settings.appUrl = 'https://philips-dev.rpxnow.com';

				janrain.settings.capture.redirectUri = removeParam(window.location.href, 'code');
				janrain.settings.capture.appId= 'eupac7ugz25x8dwahvrbpmndf8';
				janrain.settings.capture.clientId = 'a6424v37rky827mn22ht7byaswxw3ns5';
				janrain.settings.capture.recaptchaPublicKey = '6LeVKb4SAAAAAGv-hg5i6gtiOV4XrLuCDsJOnYoP';
				janrain.settings.capture.responseType = 'token';
				janrain.settings.capture.captureServer = 'https://philips.dev.janraincapture.com';
				janrain.settings.capture.registerFlow = 'socialRegistration';
				janrain.settings.capture.transactionTimeout = 10000;
				janrain.settings.capture.flowVersion = 'HEAD';
				janrain.settings.capture.flowName = 'signIn';
				janrain.settings.capture.screenToRender = 'resetPasswordRequestCode';
				janrain.settings.capture.stylesheets = ['stylesheets/philips.css'];

				janrain.settings.capture.federate = true;
				janrain.settings.capture.federateServer = 'https://philips-dev.janrainsso.com';
				janrain.settings.capture.federateXdReceiver = 'http://' + window.location.host + '/philips-dev/xdcomm.html';
				janrain.settings.capture.federateLogoutUri = 'http://' + window.location.host + '/philips-dev/logout.html';

				janrain.settings.type = 'embed';
				janrain.settings.tokenUrl = 'https://localhost/';
				janrain.settings.tokenAction = 'event';
				janrain.settings.format = 'two column';
				janrain.settings.providers = ['facebook', 'twitter','yahoo','google','linkedin','paypal'];
				janrain.settings.providersPerPage = 4;
				janrain.settings.actionText = ' ';
				janrain.settings.borderColor = '#ffffff';
				janrain.settings.backgroundColor = '#f6f6f6';

				janrain.settings.language = getCookie('lang');
				if (!janrain.settings.language) {
					janrain.settings.language = 'en-GB';
				}

				janrain.settings.capture.modalBorderOpacity = 1;
				janrain.settings.capture.modalBorderWidth = 5;
				janrain.settings.capture.modalBorderRadius = 5;
				janrain.settings.capture.modalCloseHtml = '<span class="janrain-icon-16 janrain-icon-ex2"></span>';
				janrain.settings.capture.modalBorderColor = '#7AB433';
				janrain.settings.capture.noModalBorderInlineCss = true;

				janrain.settings.packages = ['login', 'capture'];

				function isReady() { janrain.ready = true; };
				if (document.addEventListener) {
					document.addEventListener("DOMContentLoaded", isReady, false);
				} else {
					window.attachEvent('onload', isReady);
				}

				var e = document.createElement('script');
				e.type = 'text/javascript';
				e.id = 'janrainAuthWidget'

				var url = document.location.protocol === 'https:' ? 'https://' : 'http://';
				url += 'd16s8pqtk4uodx.cloudfront.net';
				url += '/philips-dev/load.js';
				e.src = url;
				var s = document.getElementsByTagName('script')[0];
				s.parentNode.insertBefore(e, s);
			})();

			function janrainWidgetOnload() {

			}
			function janrainCaptureWidgetOnLoad() {
				janrain.capture.ui.start();
				janrain.events.onCaptureRenderComplete.addHandler(function(result) {
					var passwordResetFunc = function(redirectURIField) {
						redirectURIField.value = 'http://' + window.location.hostname + '/philips-dev/reset-password.html?foo=1&bar=baz';
					};
					var emailVerifyFunc = function(redirectURIField) {
						var emailVerifyURL = 'http://' + window.location.hostname + '/philips-dev/verify-email.html?foo=1&bar=baz';
						redirectURIField.value = emailVerifyURL;
						janrain.settings.capture.redirectUri = emailVerifyURL;
					};
					var funcTable = {
						'emailAddressForm': emailVerifyFunc,
						'forgotPasswordForm': passwordResetFunc,
						'registrationForm': emailVerifyFunc,
						'registrationFormBlank': emailVerifyFunc,
						'resendVerificationForm': emailVerifyFunc,
						'resetPasswordForm': passwordResetFunc,
						'socialRegistrationForm': emailVerifyFunc,
						'socialRegistrationNoEmailFinishForm': emailVerifyFunc
					}
					for (var i in document.forms) {
						var form = document.forms[i];
						if (funcTable[form.name] && form.redirect_uri) {
							funcTable[form.name](form.redirect_uri);
						}
					}
				});
				janrain.capture.ui.registerFunction('passwordValidation', function(name, value) {
					return /([a-zA-Z].*[0-9._@$])|([0-9].*[a-zA-Z._@$])|([._@$].*[a-zA-Z0-9])/.test(value);
				});
			}
		</script>
	</head>
	<body class="janrain-font">
		<div style="display:none;" id="resetPassword">
			<div class="capture_header">
				<h1>Change password</h1>
			</div>
			{* #newPasswordForm *}
				{* newPassword *}
				{* newPasswordConfirm *}
				<div class="capture_footer">
					{* submitButton *}
				</div>
			{* /newPasswordForm *}
		</div>
		<div style="display:none;" id="resetPasswordSuccess">
			<div class="capture_header">
				<h1>Your password has been changed</h1>
			</div>
			<p>Password has been successfully updated.</p>
			<div class="capture_footer">
				<a href="index.html" class="capture_btn capture_primary">Sign in</a>
			</div>
		</div>
		<div style="display:none;" id="resetPasswordRequestCode">
			<div class="capture_header">
				<h1>Create a new password</h1>
			</div>
			<p>We didn't recognize that password reset code. Enter your email address to get a new one.</p>
			{* #resetPasswordForm *}
				{* traditionalSignIn_emailAddress *}
				<div class="capture_footer">
					{* forgotPassword_sendButton *}
				</div>
			{* /resetPasswordForm *}
		</div>
		<div style="display:none;" id="resetPasswordRequestCodeSuccess">
			<div class="capture_header">
				<h1>Create a new password</h1>
			</div>
			<p>We've sent an email with instructions to create a new password. Your existing password has not been changed.</p>
			<div class="capture_footer">
				<a href="#" onclick="document.getElementById('resetPasswordRequestCodeSuccess').style.display = 'none';" class="capture_btn capture_primary">Close</a>
			</div>
		</div>
	</body>
</html>
